<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- PRIVACY SHIELD: Prevents Google from indexing this page -->
    <meta name="robots" content="noindex, nofollow">
    <title>The Milo Fam Holiday Hunt - 2027 Edition</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Montserrat:wght@300;600&display=swap" rel="stylesheet">
    
    <style>
        /* --- SNOWY THEME CSS STYLES --- */
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            /* Allow scrolling on mobile */
            min-height: 100vh;
            /* Fix background so it doesn't scroll away */
            background: radial-gradient(circle at bottom, #1b2735 0%, #090a0f 100%) fixed;
            color: #ffffff;
            font-family: 'Montserrat', sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        #snow-canvas {
            position: fixed; /* Fixed position for scrolling */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
        }

        .container {
            position: relative;
            z-index: 10;
            padding: 40px 20px; /* More padding for mobile safe areas */
            max-width: 800px;
            width: 100%;
            box-sizing: border-box;
        }

        /* TREASURE WIDGET STYLES */
        .treasure-widget {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 12px;
            padding: 15px 25px;
            margin: 0 auto 40px auto;
            display: inline-block;
            backdrop-filter: blur(5px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.4);
            transition: all 0.5s ease;
        }

        .treasure-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            opacity: 0.7;
            margin-bottom: 5px;
        }

        .treasure-value {
            font-family: 'Cinzel', serif;
            font-size: 1.4rem;
            color: #ffffff; /* White instead of Gold */
            text-shadow: 0 0 15px rgba(255, 255, 255, 0.4);
            font-weight: 700;
            line-height: 1.4;
        }

        .treasure-claimed {
            color: #ff6b6b; /* Red for claimed */
            text-shadow: 0 0 15px rgba(255, 107, 107, 0.4);
        }

        h1 {
            font-family: 'Cinzel', serif;
            font-size: 3rem;
            margin-bottom: 20px;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
            letter-spacing: 2px;
            line-height: 1.2;
        }

        p.subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 40px;
            letter-spacing: 0.5px;
            line-height: 1.6;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Countdown Timer Styles */
        #timer {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .time-unit {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            padding: 15px;
            border-radius: 10px;
            min-width: 80px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        .number {
            font-size: 2.5rem;
            font-weight: 600;
        }

        .label {
            font-size: 0.8rem;
            text-transform: uppercase;
            opacity: 0.7;
            margin-top: 5px;
        }

        /* HIDDEN CONTENT (Reveals at Zero Hour) */
        #reveal-content {
            display: none; 
            animation: fadeIn 2s ease;
        }

        .btn-start {
            margin-top: 30px;
            background: linear-gradient(135deg, #f6d365 0%, #fda085 100%);
            border: none;
            padding: 15px 40px;
            font-size: 1.2rem;
            color: #333;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 0 20px rgba(253, 160, 133, 0.6);
            transition: transform 0.2s;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-decoration: none;
            display: inline-block;
        }

        .btn-start:hover {
            transform: scale(1.05);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Mobile Adjustments */
        @media (max-width: 600px) {
            h1 { font-size: 1.8rem; }
            p.subtitle { font-size: 0.9rem; }
            .number { font-size: 1.5rem; }
            .time-unit { min-width: 60px; padding: 10px; }
            #timer { gap: 10px; }
        }
    </style>
</head>
<body>

    <canvas id="snow-canvas"></canvas>

    <div class="container">
        
        <!-- TREASURE STATUS WIDGET -->
        <div class="treasure-widget" id="treasure-widget">
            <div class="treasure-label">Treasure Status</div>
            <div id="treasure-value" class="treasure-value">Checking...</div>
        </div>

        <!-- WAIT MODE -->
        <div id="wait-mode">
            <h1>The Mil<span id="secret-o">o</span> Fam Holiday Hunt - 2027 Edition</h1>
            <p class="subtitle">Something special is arriving soon! When the countdown reaches zero, get cracking on 12 fun puzzles.  The first ones might seem easy, but they get harder as you get closer to the end.  Be the first to solve all 12 puzzles, then claim the treasure!  Happy holidays, and happy hunting!</p>
            
            <div id="timer">
                <div class="time-unit">
                    <span class="number" id="days">00</span>
                    <span class="label">Days</span>
                </div>
                <div class="time-unit">
                    <span class="number" id="hours">00</span>
                    <span class="label">Hours</span>
                </div>
                <div class="time-unit">
                    <span class="number" id="minutes">00</span>
                    <span class="label">Mins</span>
                </div>
                <div class="time-unit">
                    <span class="number" id="seconds">00</span>
                    <span class="label">Secs</span>
                </div>
            </div>
        </div>

        <!-- REVEAL MODE -->
        <div id="reveal-content">
            <h1>Let's goooo!</h1>
            <p class="subtitle">The treasure hunt is now open.  Good luck, players.</p>
            <!-- BUTTON WILL BE INJECTED HERE BY JAVASCRIPT FOR SECURITY -->
            <div id="button-container"></div>
        </div>
    </div>

    <script>
        /* --- CONFIGURATION --- */
        const targetDate = new Date(2026, 11, 25, 9, 0, 0).getTime(); 
        const treasureAddress = 'bc1qdluefrhrzu3px5p3x6qfgdcuw6qlyymwsk8kjy';

        const _0x4f2a = [49, 45, 99, 97, 112, 105, 116, 97, 108, 46, 104, 116, 109, 108];

        function _decode(_array) {
            return String.fromCharCode(..._array);
        }

        /* --- TREASURE CHECKER --- */
        async function checkTreasureStatus() {
            try {
                // Fetch address balance and current price in parallel
                const [addressRes, priceRes] = await Promise.all([
                    fetch(`https://mempool.space/api/address/${treasureAddress}`),
                    fetch('https://mempool.space/api/v1/prices')
                ]);

                const addressData = await addressRes.json();
                const priceData = await priceRes.json();
                
                // Calculate balance in Satoshis
                const chainBalance = addressData.chain_stats.funded_txo_sum - addressData.chain_stats.spent_txo_sum;
                const mempoolBalance = addressData.mempool_stats.funded_txo_sum - addressData.mempool_stats.spent_txo_sum;
                const totalSats = chainBalance + mempoolBalance;
                
                // Calculate USD value
                const btcPrice = priceData.USD;
                const usdValue = (totalSats / 100000000) * btcPrice;
                
                const displayEl = document.getElementById('treasure-value');
                
                if (totalSats > 0) {
                    displayEl.innerHTML = `${totalSats.toLocaleString()} satoshis<br><span style="font-size: 0.8em; opacity: 0.8;">$${usdValue.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</span>`;
                } else {
                    displayEl.innerText = "CLAIMED";
                    displayEl.classList.add('treasure-claimed');
                    // Update widget border to red to indicate claimed status
                    document.getElementById('treasure-widget').style.borderColor = "rgba(255, 107, 107, 0.3)";
                }
            } catch (error) {
                console.error("Error fetching treasure status:", error);
                document.getElementById('treasure-value').innerText = "Status Unknown";
            }
        }
        
        // Check immediately on load
        checkTreasureStatus();

        /* --- REVEAL LOGIC --- */
        function revealHunt() {
            // Stop the timer
            clearInterval(timerInterval);
            
            // Swap screens
            document.getElementById("wait-mode").style.display = "none";
            document.getElementById("reveal-content").style.display = "block";
            
            // Prevent duplicate buttons if clicked multiple times
            const container = document.getElementById("button-container");
            if (container.innerHTML === "") {
                const btn = document.createElement("a");
                btn.className = "btn-start";
                btn.innerText = "Begin The Hunt";
                btn.href = _decode(_0x4f2a); 
                container.appendChild(btn);
            }
        }

        /* --- TIMER LOGIC --- */
        const timerInterval = setInterval(function() {
            const now = new Date().getTime();
            const distance = targetDate - now;

            // Calculations
            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);

            // Display
            document.getElementById("days").innerText = days < 10 ? "0" + days : days;
            document.getElementById("hours").innerText = hours < 10 ? "0" + hours : hours;
            document.getElementById("minutes").innerText = minutes < 10 ? "0" + minutes : minutes;
            document.getElementById("seconds").innerText = seconds < 10 ? "0" + seconds : seconds;

            // If the count down is finished
            if (distance < 0) {
                revealHunt();
            }
        }, 1000);

        /* --- SECRET TRIGGER --- */
        document.getElementById("secret-o").addEventListener("click", revealHunt);

        /* --- SNOW ANIMATION LOGIC --- */
        const canvas = document.getElementById("snow-canvas");
        const ctx = canvas.getContext("2d");
        let width = window.innerWidth;
        let height = window.innerHeight;
        canvas.width = width;
        canvas.height = height;

        const particles = [];
        const particleCount = 100;

        class Particle {
            constructor() {
                this.x = Math.random() * width;
                this.y = Math.random() * height;
                this.radius = Math.random() * 3 + 1;
                this.speedY = Math.random() * 1 + 0.5;
                this.speedX = Math.random() * 0.5 - 0.25;
                this.opacity = Math.random() * 0.5 + 0.3;
            }
            update() {
                this.y += this.speedY;
                this.x += this.speedX;
                if (this.y > height) this.y = 0;
                if (this.x > width) this.x = 0;
                if (this.x < 0) this.x = width;
            }
            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.fillStyle = `rgba(255, 255, 255, ${this.opacity})`;
                ctx.fill();
            }
        }

        for (let i = 0; i < particleCount; i++) {
            particles.push(new Particle());
        }

        function animate() {
            ctx.clearRect(0, 0, width, height);
            particles.forEach(p => {
                p.update();
                p.draw();
            });
            requestAnimationFrame(animate);
        }
        animate();

        window.addEventListener('resize', () => {
            width = window.innerWidth;
            height = window.innerHeight;
            canvas.width = width;
            canvas.height = height;
        });
    </script>
</body>
</html>
