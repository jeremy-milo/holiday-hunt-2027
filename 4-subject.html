<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <title>4. subject</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Montserrat:wght@300;600&display=swap" rel="stylesheet">
    
    <style>
        body, html {
            margin: 0; padding: 0; 
            width: 100%; min-height: 100vh;
            background: radial-gradient(circle at bottom, #1b2735 0%, #090a0f 100%) fixed;
            color: #ffffff; font-family: 'Montserrat', sans-serif;
            display: flex; 
            align-items: flex-start;
            justify-content: center; 
            text-align: center;
            padding-top: 50px;
            box-sizing: border-box;
            overflow-x: hidden;
            user-select: none;
        }
        #snow-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; pointer-events: none; }
        
        .container { 
            position: relative; z-index: 10; 
            padding: 20px;
            max-width: 800px; width: 100%; 
            box-sizing: border-box; 
        }

        h1 { font-family: 'Cinzel', serif; font-size: 2rem; margin-bottom: 10px; text-shadow: 0 0 10px rgba(255, 255, 255, 0.5); }
        p.instructions { margin-bottom: 20px; font-size: 0.9rem; opacity: 0.8; }
        
        #game-container {
            position: relative;
            width: 100%;
            max-width: 700px;
            height: 300px;
            margin: 0 auto;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 10px;
            background: linear-gradient(to bottom, #87CEEB, #E0F7FA); /* Sky Blue to Snowy White */
            overflow: hidden;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            cursor: pointer;
        }

        canvas#gameCanvas {
            width: 100%;
            height: 100%;
            display: block;
        }

        #ui-layer {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            background: rgba(0,0,0,0.6);
            transition: opacity 0.3s;
        }

        .hidden-ui { opacity: 0; pointer-events: none; }
        
        #start-btn, #next-level-btn {
            padding: 15px 40px; font-size: 1.2rem; 
            background: linear-gradient(135deg, #f6d365 0%, #fda085 100%); 
            border: none; border-radius: 50px; 
            cursor: pointer; font-weight: bold; 
            color: #333; text-transform: uppercase; 
            transition: transform 0.2s;
            margin-top: 10px;
        }
        #start-btn:hover, #next-level-btn:hover { transform: scale(1.05); }

        .game-msg {
            font-family: 'Cinzel', serif;
            font-size: 2rem;
            color: #fff;
            margin-bottom: 20px;
            text-shadow: 0 0 10px #f6d365;
        }

        /* Hidden text styling */
        .hidden-clue {
            color: rgba(255, 255, 255, 0.3);
            font-size: 1rem;
            margin-bottom: 50px;
            font-family: 'Courier New', monospace;
            letter-spacing: 2px;
        }
    </style>
</head>
<body>
    <canvas id="snow-canvas"></canvas>
    
    <div class="container">
        <h1>Puzzle Four: Willow's Run</h1>
        <p class="instructions">Tap, Click, or press Spacebar to Jump. Avoid the stumps, logs and holes!</p>
        
        <div id="game-container">
            <canvas id="gameCanvas"></canvas>
            
            <div id="ui-layer">
                <div id="start-screen">
                    <div class="game-msg">Ready to Run?</div>
                    <button id="start-btn">Start Game</button>
                </div>
                
                <div id="game-over-screen" style="display:none;">
                    <div class="game-msg" style="color: #ff6b6b; text-shadow: 0 0 10px red;">Ouch!</div>
                    <button onclick="resetGame()" id="start-btn">Try Again</button>
                </div>

                <div id="win-screen" style="display:none;">
                    <div class="game-msg">Good Girl Willow!</div>
                    <button id="next-level-btn" onclick="goToNextLevel()">Next Puzzle</button>
                </div>
            </div>
        </div>

        <!-- The Long Space -->
        <div style="height: 1000px;"></div>

        <!-- The Hidden Clue -->
        <div class="hidden-clue">4. subject</div>
    </div>

    <script>
        /* --- NAVIGATION --- */
        const _next = [104, 111, 108, 105, 100, 97, 121, 45, 104, 117, 110, 116, 45, 116, 114, 101, 97, 115, 117, 114, 101, 46, 104, 116, 109, 108];

        function goToNextLevel() {
            try {
                // Convert ASCII codes to string
                const nextLevelUrl = String.fromCharCode(..._next);

                // Ensure the constructed URL is valid
                if (!nextLevelUrl || typeof nextLevelUrl !== 'string') {
                    throw new Error('Next level URL is invalid or empty.');
                }

                // Navigate to the next level
                window.location.href = nextLevelUrl;
            } catch (error) {
                console.error('Error navigating to the next level:', error.message);
                alert('An error occurred while navigating to the next level. Please try again.');
            }
        }
    </script>
</body>
</html>